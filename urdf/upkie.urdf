<?xml version="1.0" encoding="utf-8" ?>
<!--

Copyright (c) 2022, StÃ©phane Caron.

This file is part of upkie_description.

upkie_description is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation, either version 3 of the License, or (at your option) any
later version.

upkie_description is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
details.

You should have received a copy of the GNU General Public License along with
upkie_description. If not, see <http://www.gnu.org/licenses/>.

Conventions in this file:

- Links and joints are grouped by "assemblies", for example "left_hip" or
  "right_knee". We can recognize assemblies in link and joint names.

- A link is named "<assembly>_<identifier>", for example
  "left_hip_qdd100_stator" denotes the stator of the qdd100 of the left hip.

- A fixed joint is named "<child_link>_fix", for instance the
  "left_hip_qdd100_stator_fix" that attaches the qdd100 stator of the left-hip
  assembly to the chassis.

Note that the moteus convention is that positive angles correspond to clockwise
rotations when looking at the rotor / back of the moteus board. This is
opposite to the URDF default, so our motor stator-rotor joint axes are aligned
with the -z axis of the joint frame. See:
https://jpieper.com/2021/04/30/moteus-direction-configuration/

And in case of doubt:

- https://wiki.ros.org/urdf/XML/joint
- https://wiki.ros.org/urdf/XML/link

-->
<robot name="upkie">

    <material name="black">
        <color rgba="0.1 0.1 0.1 1" />
    </material>

    <material name="dark_gray">
        <color rgba="0.3 0.3 0.3 1" />
    </material>

    <material name="light_gray">
        <color rgba="0.8 0.8 0.8 1" />
    </material>

    <material name="orange">
        <color rgba="1.0 0.5 0.0 1" />
    </material>

    <material name="light_wood">
        <color rgba="1 0.77 0.48 1" />
    </material>

    <material name="terracotta_light">
        <color rgba="0.93 0.64 0.52 1" />
    </material>

    <material name="terracotta_transparent">
        <color rgba="0.93 0.64 0.52 0.8" />
    </material>

    <material name="chalky_blue">
        <color rgba="0.65 0.76 0.91 1" />
    </material>

    <material name="mj5208_rotor">
        <color rgba="0.5 0.55 0.6 1.0" />
    </material>

    <material name="mj5208_stator">
        <color rgba="0.22 0.22 0.25 1.0" />
    </material>

    <link name="base">
        <visual>
            <geometry>
                <box size="0.01 0.001 0.001" />
            </geometry>
            <material name="orange" />
        </visual>
        <collision>
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.001" />
            <!-- ./box_inertia.py 0.001 0.01 0.01 0.01 -->
            <inertia ixx="1.6666666666666667e-08" ixy="0" ixz="0" iyx="0" iyy="1.6666666666666667e-08" iyz="0" izx="0" izy="0" izz="1.6666666666666667e-08" />
        </inertial>
    </link>

    <!-- IMU -->

    <link name="imu">
        <visual>
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
            <material name="orange" />
        </visual>
        <collision>
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.001" />
            <!-- ./box_inertia.py 0.001 0.01 0.01 0.01 -->
            <inertia ixx="1.6666666666666667e-08" ixy="0" ixz="0" iyx="0" iyy="1.6666666666666667e-08" iyz="0" izx="0" izy="0" izz="1.6666666666666667e-08" />
        </inertial>
    </link>

    <joint name="imu_fix" type="fixed">
        <origin rpy="0 0 0" xyz="0 0 0"/>  <!-- no translation -->
        <parent link="base" />
        <child link="imu" />
    </joint>

    <!-- Chassis -->

    <link name="chassis">
        <visual>
            <geometry>
                <box size="0.125 0.17 0.25" />
            </geometry>
            <material name="terracotta_transparent" />
        </visual>
        <collision>
            <geometry>
                <box size="0.125 0.17 0.25" />
            </geometry>
        </collision>
        <inertial>
            <mass value="1.0" />  <!-- measured net mass (5.4 [kg]) minus everything else -->
            <!-- ./box_inertia.py 1.0 0.125 0.17 0.25 -->
            <inertia ixx="0.007616666666666667" ixy="0" ixz="0" iyx="0" iyy="0.006510416666666666" iyz="0" izx="0" izy="0" izz="0.0037104166666666674" />
        </inertial>
    </link>

    <joint name="chassis_fix" type="fixed">
        <origin rpy="0 0 0" xyz="0 0 -0.1"/>
        <parent link="base" />
        <child link="chassis" />
    </joint>

    <!-- Battery -->

    <link name="battery">
        <visual>
            <geometry>
                <box size="0.13 0.074 0.055" />
            </geometry>
            <material name="dark_gray" />
        </visual>
        <collision>
            <geometry>
                <box size="0.13 0.074 0.055" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.800" />  <!-- imprecise measurement -->
            <!-- ./box_inertia.py 0.800 0.13 0.074 0.055 -->
            <inertia ixx="0.0005667333333333332" ixy="0" ixz="0" iyx="0" iyy="0.0013283333333333335" iyz="0" izx="0" izy="0" izz="0.0014917333333333332" />
        </inertial>
    </link>

    <joint name="battery_fix" type="fixed">
        <origin rpy="1.5707963267948966 0 1.5707963267948966" xyz="-0.04 0 0"/>
        <parent link="chassis" />
        <child link="battery" />
    </joint>

    <!-- Handle -->

    <link name="handle">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/handle.stl" />
            </geometry>
            <material name="terracotta_light" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.01"/>
            <geometry>
                <box size="0.120 0.07 0.04" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.01"/>
            <mass value="0.0525"/>  <!-- measured -->
            <!-- ./box_inertia.py 0.0525 0.120 0.07 0.04 -->
            <inertia ixx="2.84375e-05" ixy="0" ixz="0" iyx="0" iyy="7e-05" iyz="0" izx="0" izy="0" izz="8.44375e-05" />
        </inertial>
    </link>

    <joint name="handle_fix" type="fixed">
        <origin rpy="0 0 -1.5707963267948966" xyz="0 0 0.135"/>
        <parent link="chassis" />
        <child link="handle" />
    </joint>

    <!-- Left leg -->

    <!-- Left hip -->

    <link name="left_hip_qdd100_stator">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_stator.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            <geometry>
                <cylinder radius="0.05" length="0.03" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            <mass value="0.47" />  <!-- guessed from spec -->
            <!-- ./cylinder_inertia.py 0.470 0.05 0.03 -->
            <inertia ixx="0.000329" ixy="0" ixz="0" iyx="0" iyy="0.000329" iyz="0" izx="0" izy="0" izz="0.0005875" />
        </inertial>
    </link>

    <joint name="left_hip_qdd100_stator_fix" type="fixed">
        <origin rpy="-1.5707963267948966 0 0" xyz="0.0 0.085 -0.064"/>
        <parent link="chassis" />
        <child link="left_hip_qdd100_stator" />
    </joint>

    <link name="left_hip_qdd100_rotor">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_rotor.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 -0.0025"/>
            <geometry>
                <cylinder radius="0.023" length="0.005" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 -0.0025"/>
            <mass value="0.015" />  <!-- guessed from spec -->
            <!-- ./cylinder_inertia.py 0.015 0.023 0.005 -->
            <inertia ixx="2.0149999999999998e-06" ixy="0" ixz="0" iyx="0" iyy="2.0149999999999998e-06" iyz="0" izx="0" izy="0" izz="3.9675e-06" />
        </inertial>
    </link>

    <joint name="left_hip" type="revolute">
        <parent link="left_hip_qdd100_stator"/>
        <child link="left_hip_qdd100_rotor"/>
        <origin rpy="0 0 0" xyz="0 0 0.0292"/>
        <axis xyz="0 0 -1"/>  <!-- search "moteus-direction-configuration" -->
        <limit lower="-1.54" upper="1.54" velocity="0.7" effort="10.0"/>
    </joint>

    <link name="left_hip_horn">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_horn.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 1.5707963267948966 0" xyz="0 0 0.025"/>
            <geometry>
                <cylinder radius="0.025" length="0.09" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 1.5707963267948966 0" xyz="0 0 0.025"/>
            <mass value="0.05267" />  <!-- measured, with screws -->
            <!-- ./cylinder_inertia.py 0.05267 0.025 0.09 -->
            <inertia ixx="4.37819375e-05" ixy="0" ixz="0" iyx="0" iyy="4.37819375e-05" iyz="0" izx="0" izy="0" izz="1.6459375e-05" />
        </inertial>
    </link>

    <joint name="left_hip_horn_fix" type="fixed">
        <parent link="left_hip_qdd100_rotor"/>
        <child link="left_hip_horn"/>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
    </joint>

    <!-- Left femur -->

    <link name="left_femur">
        <visual>
            <geometry>
                <cylinder length="0.25" radius="0.011"/>
            </geometry>
            <material name="light_wood" />
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.012" length="0.26" />
            </geometry>
            <material name="light_wood" />
        </collision>
        <inertial>
            <mass value="0.056" />  <!-- measured, average over four sticks -->
            <!-- ./cylinder_inertia.py 0.056 0.012 0.026 -->
            <inertia ixx="5.170666666666667e-06" ixy="0" ixz="0" iyx="0" iyy="5.170666666666667e-06" iyz="0" izx="0" izy="0" izz="4.0320000000000005e-06" />
        </inertial>
    </link>

    <joint name="left_femur_fix" type="fixed">
        <parent link="left_hip_qdd100_rotor"/>
        <child link="left_femur"/>
        <origin rpy="1.5707963267948966 0 0" xyz="0 0.07 0.025"/>
    </joint>

    <!-- Left knee -->

    <joint name="left_knee_stator_fix" type="fixed">
        <parent link="left_femur"/>
        <child link="left_knee_stator"/>
        <origin rpy="0 0 -1.5707963267948966" xyz="0 0.042 -0.098"/>
    </joint>

    <link name="left_knee_stator">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/knee_stator.stl" />
            </geometry>
            <material name="terracotta_light" />
        </visual>
        <collision>
            <origin rpy="0 1.5707963267948966 0" xyz="0.03 0 0"/>
            <geometry>
                <cylinder radius="0.05" length="0.06" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 1.5707963267948966 0" xyz="0.03 0 0"/>
            <mass value="0.09874" />  <!-- Used Filament estimate from Prusa Slicer -->
            <!-- ./cylinder_inertia.py 0.09874 0.05 0.06 -->
            <inertia ixx="9.133450000000001e-05" ixy="0" ixz="0" iyx="0" iyy="9.133450000000001e-05" iyz="0" izx="0" izy="0" izz="0.000123425" />
        </inertial>
    </link>

    <link name="left_knee_qdd100_stator">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_stator.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            <geometry>
                <cylinder radius="0.05" length="0.03" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            <mass value="0.47" />  <!-- guessed from spec -->
            <!-- ./cylinder_inertia.py 0.470 0.05 0.03 -->
            <inertia ixx="0.000329" ixy="0" ixz="0" iyx="0" iyy="0.000329" iyz="0" izx="0" izy="0" izz="0.0005875" />
        </inertial>
    </link>

    <joint name="left_knee_qdd100_stator_fix" type="fixed">
        <parent link="left_knee_stator"/>
        <child link="left_knee_qdd100_stator"/>
        <origin rpy="-1.5707963267948966 0 1.5707963267948966" xyz="0 0 0"/>
    </joint>

    <joint name="left_knee" type="revolute">
        <parent link="left_knee_qdd100_stator"/>
        <child link="left_knee_qdd100_rotor"/>
        <origin rpy="0 0 0" xyz="0 0 0.0292"/>
        <axis xyz="0 0 -1"/>  <!-- search "moteus-direction-configuration" -->
        <limit lower="-2.57" upper="2.57" velocity="0.7" effort="10.0"/>
    </joint>

    <link name="left_knee_qdd100_rotor">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_rotor.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 -0.0025"/>
            <geometry>
                <cylinder radius="0.023" length="0.005" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 -0.0025"/>
            <mass value="0.015" />  <!-- guessed from spec -->
            <!-- ./cylinder_inertia.py 0.015 0.023 0.005 -->
            <inertia ixx="2.0149999999999998e-06" ixy="0" ixz="0" iyx="0" iyy="2.0149999999999998e-06" iyz="0" izx="0" izy="0" izz="3.9675e-06" />
        </inertial>
    </link>

    <link name="left_knee_horn">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_horn.stl" />
            </geometry>
            <material name="terracotta_light" />
        </visual>
        <collision>
            <origin rpy="0 1.5707963267948966 0" xyz="0 0 0.025"/>
            <geometry>
                <cylinder radius="0.025" length="0.09" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 1.5707963267948966 0" xyz="0 0 0.025"/>
            <mass value="0.05267" />  <!-- measured, with screws -->
            <!-- ./cylinder_inertia.py 0.05267 0.025 0.09 -->
            <inertia ixx="4.37819375e-05" ixy="0" ixz="0" iyx="0" iyy="4.37819375e-05" iyz="0" izx="0" izy="0" izz="1.6459375e-05" />
        </inertial>
    </link>

    <joint name="left_knee_horn_fix" type="fixed">
        <parent link="left_knee_qdd100_rotor"/>
        <child link="left_knee_horn"/>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
    </joint>

    <!-- Left tibia -->

    <link name="left_tibia">
        <visual>
            <geometry>
                <cylinder length="0.25" radius="0.011"/>
            </geometry>
            <material name="light_wood" />
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.012" length="0.26" />
            </geometry>
            <material name="light_wood" />
        </collision>
        <inertial>
            <mass value="0.056" />  <!-- measured, average over four sticks -->
            <!-- ./cylinder_inertia.py 0.056 0.012 0.026 -->
            <inertia ixx="5.170666666666667e-06" ixy="0" ixz="0" iyx="0" iyy="5.170666666666667e-06" iyz="0" izx="0" izy="0" izz="4.0320000000000005e-06" />
        </inertial>
    </link>

    <joint name="left_tibia_fix" type="fixed">
        <parent link="left_knee_qdd100_rotor"/>
        <child link="left_tibia"/>
        <origin rpy="1.5707963267948966 3.141592653589793 0" xyz="0 0.07 0.025"/>
    </joint>

    <!-- Left ankle -->

    <link name="left_ankle_base">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/ankle_stator.stl" />
            </geometry>
            <material name="chalky_blue" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0.002 0.0275" />
            <geometry>
                <box size="0.092 0.068 0.056" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0.002 0.0275" />
            <mass value="0.07863" />  <!-- measured, with screws -->
            <!-- ./box_inertia.py 0.07863 0.092 0.068 0.056 -->
            <inertia ixx="5.084740000000001e-05" ixy="0" ixz="0" iyx="0" iyy="7.6009e-05" iyz="0" izx="0" izy="0" izz="8.575912e-05" />
        </inertial>
    </link>

    <joint name="left_ankle_base_fix" type="fixed">
        <parent link="left_tibia"/>
        <child link="left_ankle_base"/>
        <origin rpy="1.5707963267948966 0 0" xyz="0 0.034 -0.105"/>
    </joint>

    <link name="left_ankle_plate">
        <visual>
            <geometry>
                <box size="0.08 0.045 0.003" />
            </geometry>
            <material name="light_gray" />
        </visual>
        <collision>
            <geometry>
                <box size="0.09 0.046 0.004" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.02" />  <!-- pure guess (^_^") -->
            <!-- ./box_inertia.py 0.02 0.09 0.046 0.004 -->
            <inertia ixx="3.5533333333333333e-06" ixy="0" ixz="0" iyx="0" iyy="1.3526666666666667e-05" iyz="0" izx="0" izy="0" izz="1.7026666666666667e-05" />
        </inertial>
    </link>

    <joint name="left_ankle_plate_fix" type="fixed">
        <parent link="left_ankle_base"/>
        <child link="left_ankle_plate"/>
        <origin rpy="0 0 0" xyz="0 0 -0.0015"/>
    </joint>

    <link name="left_ankle_mj5208_stator">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/mj5208_stator.stl" />
            </geometry>
            <material name="mj5208_stator" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.01" />
            <geometry>
                <cylinder radius="0.03" length="0.018" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.01" />
            <mass value="0.1721" />  <!-- measured 242.1 [g], minus 20 [g] for the plate, minus 50 [g] for the rotor -->
            <!-- ./cylinder_inertia.py 0.1721 0.03 0.018 -->
            <inertia ixx="4.3369200000000005e-05" ixy="0" ixz="0" iyx="0" iyy="4.3369200000000005e-05" iyz="0" izx="0" izy="0" izz="7.7445e-05" />
        </inertial>
    </link>

    <joint name="left_ankle_mj5208_stator_fix" type="fixed">
        <parent link="left_ankle_plate"/>
        <child link="left_ankle_mj5208_stator"/>
        <origin rpy="3.141592653589793 0 0" xyz="0 0 -0.0015"/>
    </joint>

    <link name="left_ankle_mj5208_rotor">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/mj5208_rotor.stl" />
            </geometry>
            <material name="mj5208_rotor" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.015" />
            <geometry>
                <cylinder radius="0.034" length="0.016" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.015" />
            <mass value="0.05" />  <!-- guess at 50 [g] for the rotor -->
            <!-- ./cylinder_inertia.py 0.05 0.034 0.016 -->
            <inertia ixx="1.551666666666667e-05" ixy="0" ixz="0" iyx="0" iyy="1.551666666666667e-05" iyz="0" izx="0" izy="0" izz="2.8900000000000005e-05" />
        </inertial>
    </link>

    <joint name="left_wheel" type="revolute">
        <parent link="left_ankle_mj5208_stator"/>
        <child link="left_ankle_mj5208_rotor"/>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <axis xyz="0 0 -1"/>  <!-- search "moteus-direction-configuration" -->
        <limit velocity="0.7" effort="1.0"/>
    </joint>

    <!-- Left wheel -->

    <link name="left_wheel_hub">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/wheel_hub.stl" />
            </geometry>
            <material name="terracotta_light" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.0125"/>
            <geometry>
                <cylinder radius="0.039" length="0.025" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.0125"/>
            <mass value="0.0454" />  <!-- measured, with hub adapter -->
            <!-- ./cylinder_inertia.py 0.0454 0.039 0.025 -->
            <inertia ixx="1.9627933333333332e-05" ixy="0" ixz="0" iyx="0" iyy="1.9627933333333332e-05" iyz="0" izx="0" izy="0" izz="3.45267e-05" />
        </inertial>
    </link>

    <joint name="left_wheel_hub_fix" type="fixed">
        <parent link="left_ankle_mj5208_rotor"/>
        <child link="left_wheel_hub"/>
        <origin rpy="0 0 0" xyz="0 0 0.0251"/>
    </joint>

    <link name="left_wheel_tire">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/wheel_tire/wheel_tire.stl" />
            </geometry>
            <material name="dark_gray" />
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.05" length="0.04" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.08715" />  <!-- measured -->
            <!-- ./cylinder_inertia.py 0.08715 0.05 0.04 -->
            <inertia ixx="6.608875000000002e-05" ixy="0" ixz="0" iyx="0" iyy="6.608875000000002e-05" iyz="0" izx="0" izy="0" izz="0.00010893750000000003" />
        </inertial>
        <contact>
            <lateral_friction value="1.0"/>
            <rolling_friction value="0.01"/>
            <stiffness value="30000"/>
            <damping value="1000"/>
        </contact>
    </link>

    <joint name="left_wheel_fix" type="fixed">
        <parent link="left_wheel_hub"/>
        <child link="left_wheel_tire"/>
        <origin rpy="0 0 0" xyz="0 0 0.0209"/>
    </joint>

    <link name="left_contact">
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0.005" />
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
            <material name="orange" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.005" />
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.005" />
            <mass value="0.01"/>  <!-- virtual -->
            <!-- ./box_inertia.py 0.01 0.01 0.01 0.01 -->
            <inertia ixx="1.6666666666666668e-07" ixy="0" ixz="0" iyx="0" iyy="1.6666666666666668e-07" iyz="0" izx="0" izy="0" izz="1.6666666666666668e-07" />
        </inertial>
    </link>

    <joint name="left_contact_fix" type="fixed">
        <parent link="left_wheel_tire"/>
        <child link="left_contact"/>
        <!-- contact target is a bit inside to avoid collisions with its box -->
        <!-- tangent contact surface would be xyz="0 0.05 0" -->
        <origin rpy="1.5707963267948966 0 0" xyz="0 0.047 0"/>
    </joint>

    <link name="left_wheel_center">
        <visual>
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
            <material name="orange" />
        </visual>
        <collision>
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.01"/>  <!-- virtual -->
            <!-- ./box_inertia.py 0.01 0.01 0.01 0.01 -->
            <inertia ixx="1.6666666666666668e-07" ixy="0" ixz="0" iyx="0" iyy="1.6666666666666668e-07" iyz="0" izx="0" izy="0" izz="1.6666666666666668e-07" />
        </inertial>
    </link>

    <joint name="left_wheel_center_fix" type="fixed">
        <parent link="left_wheel_tire"/>
        <child link="left_wheel_center"/>
        <origin rpy="1.5707963267948966 3.141592653589793 0" xyz="0 0 0"/>
    </joint>

    <!-- Right leg -->

    <!-- Right hip -->

    <link name="right_hip_qdd100_stator">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_stator.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            <geometry>
                <cylinder radius="0.05" length="0.03" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            <mass value="0.47" />  <!-- guessed from spec -->
            <!-- ./cylinder_inertia.py 0.470 0.05 0.03 -->
            <inertia ixx="0.000329" ixy="0" ixz="0" iyx="0" iyy="0.000329" iyz="0" izx="0" izy="0" izz="0.0005875" />
        </inertial>
    </link>

    <joint name="right_hip_qdd100_stator_fix" type="fixed">
        <origin rpy="1.5707963267948966 3.141592653589793 0" xyz="0.0 -0.085 -0.064"/>
        <parent link="chassis" />
        <child link="right_hip_qdd100_stator" />
    </joint>

    <link name="right_hip_qdd100_rotor">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_rotor.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 -0.0025"/>
            <geometry>
                <cylinder radius="0.023" length="0.005" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 -0.0025"/>
            <mass value="0.015" />  <!-- guessed from spec -->
            <!-- ./cylinder_inertia.py 0.015 0.023 0.005 -->
            <inertia ixx="2.0149999999999998e-06" ixy="0" ixz="0" iyx="0" iyy="2.0149999999999998e-06" iyz="0" izx="0" izy="0" izz="3.9675e-06" />
        </inertial>
    </link>

    <joint name="right_hip" type="revolute">
        <parent link="right_hip_qdd100_stator"/>
        <child link="right_hip_qdd100_rotor"/>
        <origin rpy="0 0 0" xyz="0 0 0.0292"/>
        <axis xyz="0 0 -1"/>  <!-- search "moteus-direction-configuration" -->
        <limit lower="-1.54" upper="1.54" velocity="0.7" effort="10.0"/>
    </joint>

    <link name="right_hip_horn">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_horn.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 1.5707963267948966 0" xyz="0 0 0.025"/>
            <geometry>
                <cylinder radius="0.025" length="0.09" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 1.5707963267948966 0" xyz="0 0 0.025"/>
            <mass value="0.05267" />  <!-- measured, with screws -->
            <!-- ./cylinder_inertia.py 0.05267 0.025 0.09 -->
            <inertia ixx="4.37819375e-05" ixy="0" ixz="0" iyx="0" iyy="4.37819375e-05" iyz="0" izx="0" izy="0" izz="1.6459375e-05" />
        </inertial>
    </link>

    <joint name="right_hip_horn_fix" type="fixed">
        <parent link="right_hip_qdd100_rotor"/>
        <child link="right_hip_horn"/>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
    </joint>

    <!-- Right femur -->

    <link name="right_femur">
        <visual>
            <geometry>
                <cylinder length="0.25" radius="0.011"/>
            </geometry>
            <material name="light_wood" />
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.012" length="0.26" />
            </geometry>
            <material name="light_wood" />
        </collision>
        <inertial>
            <mass value="0.056" />  <!-- measured, average over four sticks -->
            <!-- ./cylinder_inertia.py 0.056 0.012 0.026 -->
            <inertia ixx="5.170666666666667e-06" ixy="0" ixz="0" iyx="0" iyy="5.170666666666667e-06" iyz="0" izx="0" izy="0" izz="4.0320000000000005e-06" />
        </inertial>
    </link>

    <joint name="right_femur_fix" type="fixed">
        <parent link="right_hip_qdd100_rotor"/>
        <child link="right_femur"/>
        <origin rpy="1.5707963267948966 0 0" xyz="0 0.07 0.025"/>
    </joint>

    <!-- Right knee -->

    <joint name="right_knee_stator_fix" type="fixed">
        <parent link="right_femur"/>
        <child link="right_knee_stator"/>
        <origin rpy="0 0 -1.5707963267948966" xyz="0 0.042 -0.098"/>
    </joint>

    <link name="right_knee_stator">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/knee_stator.stl" />
            </geometry>
            <material name="terracotta_light" />
        </visual>
        <collision>
            <origin rpy="0 1.5707963267948966 0" xyz="0.03 0 0"/>
            <geometry>
                <cylinder radius="0.05" length="0.06" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 1.5707963267948966 0" xyz="0.03 0 0"/>
            <mass value="0.09874" />  <!-- Used Filament estimate from Prusa Slicer -->
            <!-- ./cylinder_inertia.py 0.09874 0.05 0.06 -->
            <inertia ixx="9.133450000000001e-05" ixy="0" ixz="0" iyx="0" iyy="9.133450000000001e-05" iyz="0" izx="0" izy="0" izz="0.000123425" />
        </inertial>
    </link>

    <link name="right_knee_qdd100_stator">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_stator.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            <geometry>
                <cylinder radius="0.05" length="0.03" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            <mass value="0.47" />  <!-- guessed from spec -->
            <!-- ./cylinder_inertia.py 0.470 0.05 0.03 -->
            <inertia ixx="0.000329" ixy="0" ixz="0" iyx="0" iyy="0.000329" iyz="0" izx="0" izy="0" izz="0.0005875" />
        </inertial>
    </link>

    <joint name="right_knee_qdd100_stator_fix" type="fixed">
        <parent link="right_knee_stator"/>
        <child link="right_knee_qdd100_stator"/>
        <origin rpy="-1.5707963267948966 0 1.5707963267948966" xyz="0 0 0"/>
    </joint>

    <joint name="right_knee" type="revolute">
        <parent link="right_knee_qdd100_stator"/>
        <child link="right_knee_qdd100_rotor"/>
        <origin rpy="0 0 0" xyz="0 0 0.0292"/>
        <axis xyz="0 0 -1"/>  <!-- search "moteus-direction-configuration" -->
        <limit lower="-2.57" upper="2.57" velocity="0.7" effort="10.0"/>
    </joint>

    <link name="right_knee_qdd100_rotor">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_rotor.stl" />
            </geometry>
            <material name="black" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 -0.0025"/>
            <geometry>
                <cylinder radius="0.023" length="0.005" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 -0.0025"/>
            <mass value="0.015" />  <!-- guessed from spec -->
            <!-- ./cylinder_inertia.py 0.015 0.023 0.005 -->
            <inertia ixx="2.0149999999999998e-06" ixy="0" ixz="0" iyx="0" iyy="2.0149999999999998e-06" iyz="0" izx="0" izy="0" izz="3.9675e-06" />
        </inertial>
    </link>

    <link name="right_knee_horn">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/qdd100_horn.stl" />
            </geometry>
            <material name="terracotta_light" />
        </visual>
        <collision>
            <origin rpy="0 1.5707963267948966 0" xyz="0 0 0.025"/>
            <geometry>
                <cylinder radius="0.025" length="0.09" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 1.5707963267948966 0" xyz="0 0 0.025"/>
            <mass value="0.05267" />  <!-- measured, with screws -->
            <!-- ./cylinder_inertia.py 0.05267 0.025 0.09 -->
            <inertia ixx="4.37819375e-05" ixy="0" ixz="0" iyx="0" iyy="4.37819375e-05" iyz="0" izx="0" izy="0" izz="1.6459375e-05" />
        </inertial>
    </link>

    <joint name="right_knee_horn_fix" type="fixed">
        <parent link="right_knee_qdd100_rotor"/>
        <child link="right_knee_horn"/>
        <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
    </joint>

    <!-- Right tibia -->

    <link name="right_tibia">
        <visual>
            <geometry>
                <cylinder length="0.25" radius="0.011"/>
            </geometry>
            <material name="light_wood" />
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.012" length="0.26" />
            </geometry>
            <material name="light_wood" />
        </collision>
        <inertial>
            <mass value="0.056" />  <!-- measured, average over four sticks -->
            <!-- ./cylinder_inertia.py 0.056 0.012 0.026 -->
            <inertia ixx="5.170666666666667e-06" ixy="0" ixz="0" iyx="0" iyy="5.170666666666667e-06" iyz="0" izx="0" izy="0" izz="4.0320000000000005e-06" />
        </inertial>
    </link>

    <joint name="right_tibia_fix" type="fixed">
        <parent link="right_knee_qdd100_rotor"/>
        <child link="right_tibia"/>
        <origin rpy="1.5707963267948966 3.141592653589793 0" xyz="0 0.07 0.025"/>
    </joint>

    <!-- Right ankle -->

    <link name="right_ankle_base">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/ankle_stator.stl" />
            </geometry>
            <material name="chalky_blue" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0.002 0.0275" />
            <geometry>
                <box size="0.092 0.068 0.056" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0.002 0.0275" />
            <mass value="0.07863" />  <!-- measured, with screws -->
            <!-- ./box_inertia.py 0.07863 0.092 0.068 0.056 -->
            <inertia ixx="5.084740000000001e-05" ixy="0" ixz="0" iyx="0" iyy="7.6009e-05" iyz="0" izx="0" izy="0" izz="8.575912e-05" />
        </inertial>
    </link>

    <joint name="right_ankle_base_fix" type="fixed">
        <parent link="right_tibia"/>
        <child link="right_ankle_base"/>
        <origin rpy="1.5707963267948966 0 0" xyz="0 0.034 -0.105"/>
    </joint>

    <link name="right_ankle_plate">
        <visual>
            <geometry>
                <box size="0.08 0.045 0.003" />
            </geometry>
            <material name="light_gray" />
        </visual>
        <collision>
            <geometry>
                <box size="0.09 0.046 0.004" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.02" />  <!-- pure guess (^_^") -->
            <!-- ./box_inertia.py 0.02 0.09 0.046 0.004 -->
            <inertia ixx="3.5533333333333333e-06" ixy="0" ixz="0" iyx="0" iyy="1.3526666666666667e-05" iyz="0" izx="0" izy="0" izz="1.7026666666666667e-05" />
        </inertial>
    </link>

    <joint name="right_ankle_plate_fix" type="fixed">
        <parent link="right_ankle_base"/>
        <child link="right_ankle_plate"/>
        <origin rpy="0 0 0" xyz="0 0 -0.0015"/>
    </joint>

    <link name="right_ankle_mj5208_stator">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/mj5208_stator.stl" />
            </geometry>
            <material name="mj5208_stator" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.01" />
            <geometry>
                <cylinder radius="0.03" length="0.018" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.01" />
            <mass value="0.1721" />  <!-- measured 242.1 [g], minus 20 [g] for the plate, minus 50 [g] for the rotor -->
            <!-- ./cylinder_inertia.py 0.1721 0.03 0.018 -->
            <inertia ixx="4.3369200000000005e-05" ixy="0" ixz="0" iyx="0" iyy="4.3369200000000005e-05" iyz="0" izx="0" izy="0" izz="7.7445e-05" />
        </inertial>
    </link>

    <joint name="right_ankle_mj5208_stator_fix" type="fixed">
        <parent link="right_ankle_plate"/>
        <child link="right_ankle_mj5208_stator"/>
        <origin rpy="3.141592653589793 0 0" xyz="0 0 -0.0015"/>
    </joint>

    <link name="right_ankle_mj5208_rotor">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/mjbots/mj5208_rotor.stl" />
            </geometry>
            <material name="mj5208_rotor" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.015" />
            <geometry>
                <cylinder radius="0.034" length="0.016" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.015" />
            <mass value="0.05" />  <!-- guess at 50 [g] for the rotor -->
            <!-- ./cylinder_inertia.py 0.05 0.034 0.016 -->
            <inertia ixx="1.551666666666667e-05" ixy="0" ixz="0" iyx="0" iyy="1.551666666666667e-05" iyz="0" izx="0" izy="0" izz="2.8900000000000005e-05" />
        </inertial>
    </link>

    <joint name="right_wheel" type="revolute">
        <parent link="right_ankle_mj5208_stator"/>
        <child link="right_ankle_mj5208_rotor"/>
        <origin rpy="0 0 0" xyz="0 0 0"/>
        <axis xyz="0 0 -1"/>  <!-- search "moteus-direction-configuration" -->
        <limit velocity="0.7" effort="1.0"/>
    </joint>

    <!-- Right wheel -->

    <link name="right_wheel_hub">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/wheel_hub.stl" />
            </geometry>
            <material name="terracotta_light" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.0125"/>
            <geometry>
                <cylinder radius="0.039" length="0.025" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.0125"/>
            <mass value="0.0454" />  <!-- measured, with hub adapter -->
            <!-- ./cylinder_inertia.py 0.0454 0.039 0.025 -->
            <inertia ixx="1.9627933333333332e-05" ixy="0" ixz="0" iyx="0" iyy="1.9627933333333332e-05" iyz="0" izx="0" izy="0" izz="3.45267e-05" />
        </inertial>
    </link>

    <joint name="right_wheel_hub_fix" type="fixed">
        <parent link="right_ankle_mj5208_rotor"/>
        <child link="right_wheel_hub"/>
        <origin rpy="0 0 0" xyz="0 0 0.0251"/>
    </joint>

    <link name="right_wheel_tire">
        <visual>
            <geometry>
                <mesh filename="package://upkie_description/meshes/wheel_tire/wheel_tire.stl" />
            </geometry>
            <material name="dark_gray" />
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.05" length="0.04" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.08715" />  <!-- measured -->
            <!-- ./cylinder_inertia.py 0.08715 0.05 0.04 -->
            <inertia ixx="6.608875000000002e-05" ixy="0" ixz="0" iyx="0" iyy="6.608875000000002e-05" iyz="0" izx="0" izy="0" izz="0.00010893750000000003" />
        </inertial>
        <contact>
            <lateral_friction value="1.0"/>
            <rolling_friction value="0.01"/>
            <stiffness value="30000"/>
            <damping value="1000"/>
        </contact>
    </link>

    <joint name="right_wheel_fix" type="fixed">
        <parent link="right_wheel_hub"/>
        <child link="right_wheel_tire"/>
        <origin rpy="0 0 0" xyz="0 0 0.0209"/>
    </joint>

    <link name="right_contact">
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0.005" />
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
            <material name="orange" />
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0.005" />
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
        </collision>
        <inertial>
            <origin rpy="0 0 0" xyz="0 0 0.005" />
            <mass value="0.01"/>  <!-- virtual -->
            <!-- ./box_inertia.py 0.01 0.01 0.01 0.01 -->
            <inertia ixx="1.6666666666666668e-07" ixy="0" ixz="0" iyx="0" iyy="1.6666666666666668e-07" iyz="0" izx="0" izy="0" izz="1.6666666666666668e-07" />
        </inertial>
    </link>

    <joint name="right_contact_fix" type="fixed">
        <parent link="right_wheel_tire"/>
        <child link="right_contact"/>
        <!-- contact target is a bit inside to avoid collisions with its box -->
        <!-- tangent contact surface would be xyz="0 0.05 0" -->
        <origin rpy="1.5707963267948966 0 0" xyz="0 0.047 0"/>
    </joint>

    <link name="right_wheel_center">
        <visual>
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
            <material name="orange" />
        </visual>
        <collision>
            <geometry>
                <box size="0.01 0.01 0.01" />
            </geometry>
        </collision>
        <inertial>
            <mass value="0.01"/>  <!-- virtual -->
            <!-- ./box_inertia.py 0.01 0.01 0.01 0.01 -->
            <inertia ixx="1.6666666666666668e-07" ixy="0" ixz="0" iyx="0" iyy="1.6666666666666668e-07" iyz="0" izx="0" izy="0" izz="1.6666666666666668e-07" />
        </inertial>
    </link>

    <joint name="right_wheel_center_fix" type="fixed">
        <parent link="right_wheel_tire"/>
        <child link="right_wheel_center"/>
        <origin rpy="1.5707963267948966 3.141592653589793 0" xyz="0 0 0"/>
    </joint>

</robot>
